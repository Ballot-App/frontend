<div class="ui container">
  <div class="ui hidden divider"></div>
  <h1 class="ui teal header">Dashboard<span *ngIf="election"> - {{election.name}}</span></h1>
  <div class="ui hidden divider"></div>
  <div class="ui grid">
    <div class="ui sixteen wide column">
      <div class="ui clearing segment">
        <span class="ui right floated header">
          <button class="ui mini basic circular button" (click)="addBallot()">
            add
          </button>
        </span>
        <h3 class="ui left floated header">
          Ballots
        </h3>
        <div class="ui hidden divider"></div>
        <div class="ui hidden divider"></div>
        <div class="ui list" *ngIf="ballots">
          <div class="item" *ngFor="let ballot of ballots">
            <div class="header">{{ballot.name}}</div>
            {{ballot.description}}
            <a class="icon right floated" (click)="viewBallot(ballot.id)">
              <i class="eye icon"></i>
            </a>
            <a class="red icon right floated" (click)="deleteBallot(ballot.id)">
              <i class="minus icon"></i>
            </a>
          </div>
        </div>
      </div>
    </div>
    <div class="ui sixteen wide column">
      <div class="ui clearing segment">
        <span class="ui right floated header">
          <button class="ui mini basic circular button" (click)="addCandidate()">
            add
          </button>
        </span>
        <h3 class="ui left floated header">
          Candidates
        </h3>
        <div class="ui hidden divider"></div>
        <div class="ui hidden divider"></div>
        <div class="ui list" *ngIf="candidates">
          <div class="item" *ngFor="let candidate of candidates | async">
            {{candidate.name}}
            <a class="red icon right floated" (click)="deleteCandidate(candidate.id)">
              <i class="minus icon"></i>
            </a>
          </div>
        </div>
      </div>
    </div>
    <div class="ui sixteen wide column">
      <div class="ui clearing segment">
        <span class="ui right floated header">
          <button class="ui mini basic circular button" (click)="showGenerateCodes()">
            generate
          </button>
        </span>
        <h3 class="ui left floated header">
          Electorate Codes
        </h3>
        <div class="ui hidden divider"></div>
        <div class="ui hidden divider"></div>
        <div class="ui list">
          <div class="item" *ngFor="let code of electorateCodes">
            {{code.id}}
            <a class="red icon right floated" (click)="deleteCode(code.id)">
              <i class="minus icon"></i>
            </a>
          </div>
        </div>
      </div>
    </div>
    <div class="ui sixteen wide column">
      <button class="large fluid red animated ui button" [swal]="deleteSwal">
        <div class="visible content">
          Delete
        </div>
        <div class="hidden content">
          This is non-reversible
        </div>
      </button>
    </div>
  </div>
</div>

<ng-template let-context let-modal="modal" #ballotModalTemplate>
  <div class="header">{{context.name}}</div>
  <div class="content">
    <p><strong>Type: </strong><span *ngIf="context.type"></span></p>
    <p><strong>Description: </strong>{{context.description}}</p>
    <div class="ui list" *ngIf="context.options">
      <div class="item" *ngFor="let option of context.options">
        {{ option.name }}
      </div>
    </div>
  </div>
</ng-template>

<ng-template let-context let-modal="modal" #addBallotModalTemplate>
  <div class="header">Add Ballot</div>
  <div class="content">
    <div class="ui labeled input">
      <div class="ui label">Name</div>
      <input type="text" placeholder="Name" [(ngModel)]="newBallotName">
    </div>
    <div class="ui labeled input">
      <div class="ui label">Description</div>
      <input type="text" placeholder="Description" [(ngModel)]="newBallotDescription">
    </div>
    <select class="ui search dropdown" [(ngModel)]="newBallotType">
      <option value="">Select Type</option>
      <option value="1">Basic</option>
      <option value="2">No Abstain</option>
      <option value="3">Single Seat</option>
      <option value="4">Multiple Seat</option>
    </select>
    <button class="ui primary button" (click)="addNewBallot(); modal.deny()">Add</button>
  </div>
</ng-template>

<ng-template let-context let-modal="modal" #addCodesModal>
  <div class="header">Generate Codes</div>
  <div class="content">
    How many codes would you like to generate?&nbsp;
    <div class="ui labeled input">
      <div class="ui label">Number of Codes</div>
      <input type="number" [(ngModel)]="newCodesCount">
    </div>
    <button class="ui primary button" (click)="generateCodes(); modal.deny()">Generate</button>
  </div>
</ng-template>

<ng-template let-context let-modal="modal" #viewCandidateModal>
  <div class="header">{{context.name}}</div>
  <div class="content">
    <div class="ui form">
      <div class="field">
        <label>Manifesto</label>
        <textarea  [(ngModel)]="newCandidateManifesto"></textarea>
      </div>
    </div>
    <div class="ui hidden divider"></div>
    <button class="ui primary fluid button" (click)="editCandidate(context.id, context.name); modal.deny()">Edit</button>
  </div>
</ng-template>

<ng-template let-context let-modal="modal" #addCandidateModal>
  <div class="header">Add Candidate</div>
  <div class="content">
    <div class="ui form">
      <div class="field">
        <label>Name</label>
        <input type="text" [(ngModel)]="newCandidateName">
      </div>
      <div class="field">
        <label>Manifesto</label>
        <textarea  [(ngModel)]="newCandidateManifesto"></textarea>
      </div>
    </div>
    <div class="ui hidden divider"></div>
    <button class="ui primary fluid button" (click)="addNewCandidate(); modal.deny()">Add</button>
  </div>
</ng-template>

<swal
  #deleteSwal
  title="Delete {{ election.name }}?"
  text="This cannot be undone"
  type="warning"
  confirmButtonText="Yes, Delete."
  confrimButtonClass="ui negative button"
  [showCancelButton]="true"
  [focusCancel]="true"
  (confirm)="deleteAccount()"
>
</swal>
